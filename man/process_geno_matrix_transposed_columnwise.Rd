% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/process_geno_matrix_transposed_columnwise.R
\name{process_geno_matrix_transposed_columnwise}
\alias{process_geno_matrix_transposed_columnwise}
\title{Process Genotype Data into Centered Coefficient Matrices (Columnwise)}
\usage{
process_geno_matrix_transposed_columnwise(
  filename,
  ploidy = 2,
  dominance = TRUE,
  min_minor_allele = 1,
  batch_size = 175
)
}
\arguments{
\item{filename}{Character string specifying the path to the CSV file containing
genotype data (hybrids as rows, markers as columns). The file must include a
header with "hybrid" as the first column followed by marker columns.}

\item{ploidy}{Integer specifying the ploidy level (e.g., 2 for diploid, 4 for tetraploid).
Must be a positive even number. Defaults to 2.}

\item{dominance}{Logical indicating whether to compute dominance coefficients in
addition to additive coefficients. If \code{TRUE}, a second \code{big.matrix} is created
for dominance effects. Defaults to \code{TRUE}.}

\item{min_minor_allele}{Integer specifying the minimum number of hybrids carrying
the minor allele required for a marker to be retained after filtering. Defaults to 1.}

\item{batch_size}{Integer specifying the number of markers to process in each batch.
Adjust to balance memory usage and performance. Defaults to 35.}
}
\value{
A list containing:
\itemize{
\item \code{coeff}: A \code{big.matrix.descriptor} pointing to the disk-based matrix of
centered genotype coefficients (rows = hybrids, columns = markers).
\item \code{coeff.D}: A \code{big.matrix.descriptor} for dominance coefficients (only
included if \code{dominance = TRUE}).
\item \code{id}: A character vector of hybrid IDs.
\item \code{markers}: A character vector of kept marker names.
}
}
\description{
Processes genotype data from a CSV file (hybrids as rows, markers as columns)
into centered coefficient matrices using a columnwise approach. Filters markers
based on minor allele count, centers genotypes around mean allele frequencies,
and optionally computes dominance coefficients. Results are stored in disk-based
\code{big.matrix} objects. Processing is done sequentially in batches to manage memory.
}
\details{
The function processes the input CSV in two passes, using sequential batch processing:
\enumerate{
\item \strong{First pass}: Reads the CSV in batches of markers to compute statistics
(sum, count, minor allele counts) and filters markers based on \code{min_minor_allele}.
\item \strong{Second pass}: Processes the CSV in batches of markers to compute
centered genotype coefficients (and dominance coefficients if requested) for
kept markers, storing results in disk-based \code{big.matrix} objects.
}
Genotypes are centered by subtracting \code{ploidy * p2}, where \code{p2} is the mean genotype
divided by ploidy. Missing values are imputed with the marker's mean genotype.
Dominance coefficients are computed as:
\code{-2 * choose(ploidy, 2) * p^2 + 2 * (ploidy - 1) * p * geno - geno * (geno - 1)}.
}
\examples{
\dontrun{
# Example with a diploid dataset
result <- process_geno_matrix_transposed_columnwise(
  filename = "insilico_hybrids_transposed.csv",
  ploidy = 2,
  dominance = TRUE,
  min_minor_allele = 5,
  batch_size = 50
)
print(result$id)
print(result$markers)
}

}
